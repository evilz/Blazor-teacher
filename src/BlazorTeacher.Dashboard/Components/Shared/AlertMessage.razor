@* 
    AlertMessage.razor
    A reusable alert/notification component.
    Demonstrates:
    - Event callbacks for component communication
    - Conditional rendering based on parameters
    - CSS classes based on state
*@

@if (IsVisible)
{
    <div class="@GetAlertClasses()" role="alert">
        <div class="flex items-center gap-3">
            <span class="flex-shrink-0">@GetIcon()</span>
            <span class="text-sm font-medium">@Message</span>
        </div>
        @if (IsDismissible)
        {
            <button type="button" @onclick="Dismiss" class="flex-shrink-0 rounded-lg p-1 hover:bg-black/10 transition-colors" aria-label="Close">
                <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        }
    </div>
}

@code {
    /// <summary>
    /// The message to display in the alert.
    /// </summary>
    [Parameter]
    public string Message { get; set; } = string.Empty;

    /// <summary>
    /// Type of alert: "success", "error", "warning", "info".
    /// </summary>
    [Parameter]
    public string Type { get; set; } = "info";

    /// <summary>
    /// Whether the alert is visible.
    /// </summary>
    [Parameter]
    public bool IsVisible { get; set; } = true;

    /// <summary>
    /// Whether the alert can be dismissed.
    /// </summary>
    [Parameter]
    public bool IsDismissible { get; set; } = true;

    /// <summary>
    /// Event callback when the alert is dismissed.
    /// Demonstrates parent-child communication.
    /// </summary>
    [Parameter]
    public EventCallback OnDismiss { get; set; }

    private async Task Dismiss()
    {
        IsVisible = false;
        await OnDismiss.InvokeAsync();
    }

    private string GetAlertClasses() => Type switch
    {
        "success" => "flex items-center justify-between rounded-lg bg-emerald-50 p-4 text-emerald-800 ring-1 ring-inset ring-emerald-200",
        "error" => "flex items-center justify-between rounded-lg bg-red-50 p-4 text-red-800 ring-1 ring-inset ring-red-200",
        "warning" => "flex items-center justify-between rounded-lg bg-amber-50 p-4 text-amber-800 ring-1 ring-inset ring-amber-200",
        _ => "flex items-center justify-between rounded-lg bg-blue-50 p-4 text-blue-800 ring-1 ring-inset ring-blue-200"
    };

    private MarkupString GetIcon() => Type switch
    {
        "success" => new MarkupString("<svg class=\"h-5 w-5 text-emerald-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" /></svg>"),
        "error" => new MarkupString("<svg class=\"h-5 w-5 text-red-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z\" /></svg>"),
        "warning" => new MarkupString("<svg class=\"h-5 w-5 text-amber-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z\" /></svg>"),
        _ => new MarkupString("<svg class=\"h-5 w-5 text-blue-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z\" /></svg>")
    };
}
